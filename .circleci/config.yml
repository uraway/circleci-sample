version: 2.1

orbs:
    cli: circleci/circleci-cli@0.1.5

jobs:
    build:
        executor: cli/default
        steps:
            - checkout
            - setup_remote_docker
            - run: circleci config process orb-test.yml > orb-test.2.0.yml
            - run:
                name: Run cicleci local execute
                command: |
                  docker container create --name tmp -v /configs busybox
                  docker cp orb-test.2.0.yml tmp:/configs
                  docker run --volumes-from tmp circleci/circleci-cli "ls -l /"
                  docker run --volumes-from tmp circleci/circleci-cli "circleci local execute --config /configs/orb-test.2.0.yml"

workflows:
  version: 2
  workflow:
    jobs:
      - build
